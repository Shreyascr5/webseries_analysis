<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Web Series Statistical Analysis</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>

  <body>
    <div class="container">
      <h1>Web Series Statistical Analysis</h1>

      <!-- ================= DATASET OVERVIEW ================= -->
      <div class="card">
        <h2>Dataset Overview</h2>
        <p><strong>Total Records:</strong> {{ rows }}</p>

        <h3>Attributes</h3>
        <ul class="columns">
          {% for col in overview_cols %}
          <li>{{ col }}</li>
          {% endfor %}
        </ul>
      </div>

      <!-- ================= DESCRIPTIVE STATISTICS ================= -->
      <div class="card">
        <h2>Descriptive Statistics</h2>
        <table>
          <tr>
            <th>Attribute</th>
            <th>Mean</th>
            <th>Std</th>
            <th>Min</th>
            <th>Max</th>
          </tr>
          {% for col in desc.columns %}
          <tr>
            <td>{{ col }}</td>
            <td>{{ desc[col]["mean"] }}</td>
            <td>{{ desc[col]["std"] }}</td>
            <td>{{ desc[col]["min"] }}</td>
            <td>{{ desc[col]["max"] }}</td>
          </tr>
          {% endfor %}
        </table>
      </div>

      <!-- ================= NORMALITY TEST ================= -->
      <div class="card">
        <h2>Normality Test</h2>

        <form method="post">
          <label>Select Numerical Attribute:</label>
          <select name="normality_col" required>
            {% for col in numeric_cols %}
            <option value="{{ col }}">{{ col }}</option>
            {% endfor %}
          </select>
          <button type="submit">Check Normality</button>
        </form>

        {% if normality_result %}
        <p>
          <strong>Decision:</strong>
          <span
            class="{{ 'accept' if normality_result == 'Normal' else 'reject' }}"
          >
            {{ normality_result }}
          </span>
        </p>

        <div class="plots">
          {% if qq_plot %}
          <img src="{{ url_for('static', filename='plots/' + qq_plot) }}" />
          {% endif %} {% if hist_plot %}
          <img src="{{ url_for('static', filename='plots/' + hist_plot) }}" />
          {% endif %} {% if box_plot %}
          <img src="{{ url_for('static', filename='plots/' + box_plot) }}" />
          {% endif %}
        </div>
        {% endif %}
      </div>

      <!-- ================= CORRELATION TEST ================= -->
      <div class="card">
        <h2>Correlation Test</h2>

        <form method="post">
          <label>X:</label>
          <select name="corr_x" required>
            {% for col in numeric_cols %}
            <option value="{{ col }}">{{ col }}</option>
            {% endfor %}
          </select>

          <label>Y:</label>
          <select name="corr_y" required>
            {% for col in numeric_cols %}
            <option value="{{ col }}">{{ col }}</option>
            {% endfor %}
          </select>

          <button type="submit">Run Test</button>
        </form>

        {% if corr_result %}
        <div class="result">
          <p>
            <strong>Null Hypothesis (H₀):</strong> {{
            corr_result.null_hypothesis }}
          </p>
          <p>
            <strong>Alternative Hypothesis (H₁):</strong> {{
            corr_result.alternative_hypothesis }}
          </p>

          <p><strong>Method Used:</strong> {{ corr_result.method }}</p>
          <p><strong>Correlation Value:</strong> {{ corr_result.corr }}</p>
          <p><strong>p-value:</strong> {{ corr_result.p_value }}</p>
          <p>
            <strong>Significance Level (α):</strong> {{ corr_result.alpha }}
          </p>

          <p>
            <strong>Decision:</strong>
            <span
              class="{{ 'reject' if corr_result.decision == 'Reject H₀' else 'accept' }}"
            >
              {{ corr_result.decision }}
            </span>
          </p>

          {% if scatter_plot %}
          <img
            src="{{ url_for('static', filename='plots/' + scatter_plot) }}"
          />
          {% endif %}
        </div>
        {% endif %}
      </div>
    </div>
  </body>
</html>
